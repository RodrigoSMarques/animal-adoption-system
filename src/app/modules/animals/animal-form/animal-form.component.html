<div class="animal-form-container">
  <div class="container">
    <div class="form-card">
      <h1>Cadastrar Animal para Ado√ß√£o</h1>

      <form [formGroup]="animalForm" (ngSubmit)="onSubmit()">
        <div class="form-section">
          <h2>Informa√ß√µes B√°sicas</h2>

          <div class="form-group">
            <label for="nome">Nome do Animal *</label>
            <input
              type="text"
              id="nome"
              formControlName="nome"
              class="form-control"
              [class.is-invalid]="f['nome'].invalid && f['nome'].touched"
              placeholder="Digite o nome"
            />
            <div class="invalid-feedback" *ngIf="f['nome'].invalid && f['nome'].touched">
              Nome √© obrigat√≥rio
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="especie">Esp√©cie *</label>
              <select id="especie" formControlName="especie" class="form-control">
                <option value="cachorro">Cachorro</option>
                <option value="gato">Gato</option>
                <option value="outro">Outro</option>
              </select>
            </div>

            <div class="form-group">
              <label for="raca">Ra√ßa *</label>
              <input
                type="text"
                id="raca"
                formControlName="raca"
                class="form-control"
                [class.is-invalid]="f['raca'].invalid && f['raca'].touched"
                placeholder="Ex: SRD, Labrador"
              />
              <div class="invalid-feedback" *ngIf="f['raca'].invalid && f['raca'].touched">
                Ra√ßa √© obrigat√≥ria
              </div>
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="idade">Idade (anos) *</label>
              <input
                type="number"
                id="idade"
                formControlName="idade"
                class="form-control"
                [class.is-invalid]="f['idade'].invalid && f['idade'].touched"
                min="0"
                step="0.5"
              />
              <div class="invalid-feedback" *ngIf="f['idade'].invalid && f['idade'].touched">
                Idade √© obrigat√≥ria
              </div>
            </div>

            <div class="form-group">
              <label for="sexo">Sexo *</label>
              <select id="sexo" formControlName="sexo" class="form-control">
                <option value="macho">Macho</option>
                <option value="femea">F√™mea</option>
              </select>
            </div>

            <div class="form-group">
              <label for="porte">Porte *</label>
              <select id="porte" formControlName="porte" class="form-control">
                <option value="pequeno">Pequeno</option>
                <option value="medio">M√©dio</option>
                <option value="grande">Grande</option>
              </select>
            </div>
          </div>

          <div class="form-group">
            <label for="descricao">Descri√ß√£o *</label>
            <textarea
              id="descricao"
              formControlName="descricao"
              class="form-control"
              [class.is-invalid]="f['descricao'].invalid && f['descricao'].touched"
              rows="5"
              placeholder="Conte sobre a personalidade, comportamento e hist√≥ria do animal..."
            ></textarea>
            <div class="invalid-feedback" *ngIf="f['descricao'].invalid && f['descricao'].touched">
              Descri√ß√£o √© obrigat√≥ria
            </div>
          </div>
        </div>

        <div class="form-section">
          <h2>Fotos do Animal</h2>
          <div class="photo-upload">
            <input
              type="file"
              id="photos"
              accept="image/*"
              multiple
              (change)="onFileSelected($event)"
              style="display: none"
            />
            <label for="photos" class="upload-label">
              <span class="upload-icon">üì∑</span>
              <span>Clique para adicionar fotos</span>
            </label>
          </div>

          <div class="photo-previews" *ngIf="previewUrls.length > 0">
            <div class="photo-preview" *ngFor="let url of previewUrls; let i = index">
              <img [src]="url" alt="Preview" />
              <button type="button" class="remove-photo" (click)="removePhoto(i)">√ó</button>
            </div>
          </div>
        </div>

        <div class="form-section">
          <h2>Localiza√ß√£o</h2>

          <div class="form-row">
            <div class="form-group">
              <label for="cidade">Cidade *</label>
              <input
                type="text"
                id="cidade"
                formControlName="cidade"
                class="form-control"
                [class.is-invalid]="f['cidade'].invalid && f['cidade'].touched"
                placeholder="Nome da cidade"
              />
              <div class="invalid-feedback" *ngIf="f['cidade'].invalid && f['cidade'].touched">
                Cidade √© obrigat√≥ria
              </div>
            </div>

            <div class="form-group">
              <label for="estado">Estado (UF) *</label>
              <input
                type="text"
                id="estado"
                formControlName="estado"
                class="form-control"
                [class.is-invalid]="f['estado'].invalid && f['estado'].touched"
                placeholder="Ex: SP"
                maxlength="2"
              />
              <div class="invalid-feedback" *ngIf="f['estado'].invalid && f['estado'].touched">
                Estado √© obrigat√≥rio
              </div>
            </div>
          </div>

          <div class="location-info">
            <p>üìç Coordenadas GPS (necess√°rias para busca por proximidade)</p>
            <button type="button" class="btn btn-location" (click)="getCurrentLocation()">
              Usar Minha Localiza√ß√£o Atual
            </button>
            <div class="coordinates" *ngIf="useCurrentLocation">
              <small>Lat: {{ f['latitude'].value }}, Long: {{ f['longitude'].value }}</small>
            </div>
          </div>
        </div>

        <div class="error-message" *ngIf="errorMessage">
          {{ errorMessage }}
        </div>

        <div class="form-actions">
          <button type="button" routerLink="/perfil" class="btn btn-secondary">
            Cancelar
          </button>
          <button type="submit" class="btn btn-primary" [disabled]="loading">
            <span *ngIf="!loading">Cadastrar Animal</span>
            <span *ngIf="loading">Cadastrando...</span>
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
